<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hasoook's Gallery</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Tailwind 配置 -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: '#FB7299', // B站粉色
            secondary: '#23ADE5',
            dark: {
              100: '#333333',
              200: '#222222',
              300: '#1A1A1A'
            },
            light: {
              100: '#FFFFFF',
              200: '#F5F5F5',
              300: '#EEEEEE'
            }
          },
          fontFamily: {
            inter: ['Inter', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .text-shadow {
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .card-hover {
        @apply transition-all duration-300 hover:shadow-xl hover:-translate-y-1;
      }
      .image-container {
        @apply relative overflow-hidden rounded-lg;
      }
      .image-thumbnail {
        @apply w-full h-full object-cover transition-transform duration-500 hover:scale-110;
      }
      .like-animation {
        animation: likePulse 0.5s ease-in-out;
      }
      @keyframes likePulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.3); }
        100% { transform: scale(1); }
      }
    }
  </style>
</head>

<body class="font-inter bg-light-200 dark:bg-dark-200 text-gray-800 dark:text-gray-200 transition-colors duration-300">
  <!-- 导航栏 -->
  <header id="navbar" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-light-100/90 dark:bg-dark-200/90 backdrop-blur-md shadow-sm">
    <div class="container mx-auto px-4 py-3 md:py-4 flex items-center justify-between">
      <!-- Logo和标题 -->
      <a href="#" class="flex items-center gap-2">
        <div class="w-10 h-10 rounded-full bg-primary flex items-center justify-center">
          <i class="fa fa-picture-o text-white text-xl"></i>
        </div>
        <h1 class="text-xl md:text-2xl font-bold tracking-tight">
          <span class="text-primary">Hasoook</span>'s Gallery
        </h1>
      </a>
      
      <!-- 桌面端导航 -->
      <nav class="hidden md:flex items-center gap-6">
        <button id="tab-fanart" class="nav-tab active py-2 font-medium text-primary border-b-2 border-primary transition-all">
          粉丝投稿
        </button>
        <button id="tab-created" class="nav-tab py-2 font-medium text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-all">
          官方创作
        </button>
        <a href="https://space.bilibili.com/" target="_blank" class="flex items-center gap-1 px-4 py-2 rounded-full bg-primary/10 text-primary hover:bg-primary/20 transition-colors">
          <i class="fa fa-bilibili"></i>
          <span>我的B站</span>
        </a>
      </nav>
      
      <!-- 主题切换按钮 -->
      <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-dark-100 transition-colors">
        <i class="fa fa-moon-o dark:hidden text-xl"></i>
        <i class="fa fa-sun-o hidden dark:block text-xl"></i>
      </button>
      
      <!-- 移动端菜单按钮 -->
      <button id="mobile-menu-btn" class="md:hidden p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-dark-100 transition-colors">
        <i class="fa fa-bars text-xl"></i>
      </button>
    </div>
    
    <!-- 移动端导航菜单 -->
    <div id="mobile-menu" class="md:hidden hidden bg-light-100 dark:bg-dark-200 border-t dark:border-gray-700">
      <div class="container mx-auto px-4 py-3 flex flex-col gap-3">
        <button id="mobile-tab-fanart" class="mobile-nav-tab active py-2 font-medium text-primary text-left">
          粉丝投稿
        </button>
        <button id="mobile-tab-created" class="mobile-nav-tab py-2 font-medium text-gray-600 dark:text-gray-400 text-left">
          官方创作
        </button>
        <a href="https://space.bilibili.com/" target="_blank" class="flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 text-primary hover:bg-primary/20 transition-colors w-fit">
          <i class="fa fa-bilibili"></i>
          <span>我的B站空间</span>
        </a>
      </div>
    </div>
  </header>

  <!-- 主内容区 -->
  <main class="container mx-auto px-4 pt-28 md:pt-32 pb-16">
    <!-- 页面标题 -->
    <div class="mb-10 text-center">
      <h2 id="page-title" class="text-[clamp(1.8rem,4vw,2.8rem)] font-bold mb-3 text-shadow">粉丝投稿作品</h2>
      <p class="text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">感谢大家的喜爱与创作，这里收集了所有粉丝绘制的Hasoook人设作品，每一份都是独特的心意。</p>
    </div>
    
    <!-- 排序和搜索 -->
    <div class="mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
      <div class="flex flex-wrap gap-2">
        <button class="sort-btn active px-4 py-2 rounded-full bg-primary text-white text-sm" data-sort="default">默认排序</button>
        <button class="sort-btn px-4 py-2 rounded-full bg-light-300 dark:bg-dark-100 text-sm hover:bg-primary/10 transition-colors" data-sort="like-desc">喜欢最多</button>
        <button class="sort-btn px-4 py-2 rounded-full bg-light-300 dark:bg-dark-100 text-sm hover:bg-primary/10 transition-colors" data-sort="date-desc">最新发布</button>
        <button class="sort-btn px-4 py-2 rounded-full bg-light-300 dark:bg-dark-100 text-sm hover:bg-primary/10 transition-colors" data-sort="date-asc">最早发布</button>
      </div>
      <div class="relative w-full sm:w-auto">
        <input type="text" placeholder="搜索作品..." class="w-full sm:w-64 pl-10 pr-4 py-2 rounded-full bg-light-300 dark:bg-dark-100 border border-gray-200 dark:border-gray-700 focus:outline-none focus:ring-2 focus:ring-primary/50">
        <i class="fa fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-500"></i>
      </div>
    </div>
    
    <!-- 粉丝投稿图片网格 -->
    <section id="fanart-gallery" class="gallery-grid grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      <!-- 图片项会通过JS动态生成 -->
    </section>
    
    <!-- 官方创作图片网格 (默认隐藏) -->
    <section id="created-gallery" class="gallery-grid grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 hidden">
      <!-- 图片项会通过JS动态生成 -->
    </section>
    
    <!-- 加载更多按钮 -->
    <div class="mt-10 text-center">
      <button id="load-more" class="px-6 py-3 rounded-full bg-light-300 dark:bg-dark-100 hover:bg-primary hover:text-white transition-all duration-300 font-medium">
        加载更多 <i class="fa fa-chevron-down ml-1"></i>
      </button>
    </div>
  </main>
  
  <!-- 图片详情模态框 -->
  <div id="image-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 opacity-0 pointer-events-none transition-opacity duration-300">
    <div class="relative w-full max-w-4xl max-h-[90vh] bg-light-100 dark:bg-dark-100 rounded-xl overflow-hidden shadow-2xl transform scale-95 transition-transform duration-300">
      <!-- 关闭按钮 -->
      <button id="close-modal" class="absolute top-4 right-4 w-10 h-10 rounded-full bg-black/50 text-white flex items-center justify-center z-10 hover:bg-black/70 transition-colors">
        <i class="fa fa-times"></i>
      </button>
      
      <!-- 模态框内容 -->
      <div class="flex flex-col md:flex-row h-full">
        <!-- 图片区域 -->
        <div class="md:w-2/3 bg-gray-100 dark:bg-gray-800 flex items-center justify-center p-4">
          <img id="modal-image" src="" alt="图片详情" class="max-w-full max-h-[60vh] md:max-h-[80vh] object-contain">
        </div>
        
        <!-- 信息区域 -->
        <div class="md:w-1/3 p-6 overflow-y-auto">
          <h3 id="modal-title" class="text-2xl font-bold mb-2"></h3>
          <p id="modal-artist" class="text-gray-600 dark:text-gray-400 mb-4"></p>
          
          <div class="flex items-center gap-3 mb-6">
            <span id="modal-date" class="px-3 py-1 rounded-full bg-light-300 dark:bg-dark-300 text-sm"></span>
            <span id="modal-like-count" class="px-3 py-1 rounded-full bg-primary/10 text-primary text-sm flex items-center gap-1">
              <i class="fa fa-heart"></i>
              <span></span>
            </span>
          </div>
          
          <div class="mb-6">
            <h4 class="text-lg font-semibold mb-2">作品描述</h4>
            <p id="modal-description" class="text-gray-700 dark:text-gray-300 leading-relaxed"></p>
          </div>
          
          <!-- 喜欢功能 -->
          <div class="flex gap-3">
            <button id="like-btn" class="flex-1 py-3 rounded-lg bg-light-300 dark:bg-dark-300 hover:bg-primary hover:text-white transition-all duration-300 flex items-center justify-center gap-2 font-medium">
              <i id="like-icon" class="fa fa-heart-o text-xl"></i>
              <span id="like-count-display">0</span>
              <span>喜欢</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- 页脚 -->
  <footer class="bg-light-100 dark:bg-dark-100 border-t dark:border-gray-800 py-8">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-6 md:mb-0">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center">
              <i class="fa fa-picture-o text-white"></i>
            </div>
            <h3 class="text-lg font-bold">
              <span class="text-primary">Hasoook</span>'s Gallery
            </h3>
          </div>
          <p class="text-sm text-gray-600 dark:text-gray-400">展示所有精彩的创作作品</p>
        </div>
        
        <div class="flex gap-6 mb-6 md:mb-0">
          <a href="https://space.bilibili.com/" target="_blank" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors">
            <i class="fa fa-bilibili text-2xl"></i>
          </a>
          <a href="#" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors">
            <i class="fa fa-weibo text-2xl"></i>
          </a>
          <a href="#" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors">
            <i class="fa fa-twitter text-2xl"></i>
          </a>
          <a href="#" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors">
            <i class="fa fa-instagram text-2xl"></i>
          </a>
        </div>
      </div>
      
      <div class="mt-8 pt-6 border-t dark:border-gray-800 text-center text-sm text-gray-500 dark:text-gray-500">
        <p>© 2023 Hasoook's Gallery. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    // 图片数据 - 包含排序所需的属性
    const imageData = {
      1: {
        title: "夏日Hasoook",
        artist: "by 小画家",
        date: "2023-06-15",
        type: "fanart",
        image: "gallery/contribution/1.png",
        thumbnail: "https://picsum.photos/seed/hasoook1/800/800",
        description: "夏天到了，画了一张Hasoook的夏日海边图，希望大家喜欢！一直很喜欢Hasoook的视频，每次看都觉得很开心，这是我第一次投稿，希望能被看到~",
        allowSave: false,
        likeCount: 128,
        isLiked: false
      },
      2: {
        title: "Q版Hasoook",
        artist: "by 萌萌子",
        date: "2023-06-10",
        type: "fanart",
        image: "https://picsum.photos/seed/hasoook2/1200/1200",
        thumbnail: "https://picsum.photos/seed/hasoook2/800/800",
        description: "画了Q版的Hasoook，太可爱了！尝试了新的绘画风格，希望大家喜欢。Hasoook的每个表情都很有特点，特别适合Q版化~",
        allowSave: true,
        likeCount: 95,
        isLiked: false
      },
      3: {
        title: "Hasoook日常",
        artist: "by 漫画达人",
        date: "2023-06-05",
        type: "fanart",
        image: "https://picsum.photos/seed/hasoook3/1200/1200",
        thumbnail: "https://picsum.photos/seed/hasoook3/800/800",
        description: "根据Hasoook视频里的一些小日常改编的四格漫画，希望能捕捉到那种轻松愉快的氛围。画漫画真的很有趣，以后还会继续创作更多~",
        allowSave: true,
        likeCount: 203,
        isLiked: false
      },
      4: {
        title: "古风Hasoook",
        artist: "by 古风爱好者",
        date: "2023-05-28",
        type: "fanart",
        image: "https://picsum.photos/seed/hasoook4/1200/1200",
        thumbnail: "https://picsum.photos/seed/hasoook4/800/800",
        description: "突发奇想画了古风版本的Hasoook，感觉意外地合适呢！参考了一些古风服饰和背景，希望能展现出不一样的气质。",
        allowSave: true,
        likeCount: 156,
        isLiked: false
      },
      11: {
        title: "惊讶表情",
        artist: "官方限定",
        date: "2023-06-20",
        type: "created",
        image: "https://picsum.photos/seed/hasoook11/1200/1200",
        thumbnail: "https://picsum.photos/seed/hasoook11/800/800",
        description: "官方定制的惊讶表情，将在后续视频中使用。特别感谢画手大大@XXX的创作，完美捕捉了想要表达的情绪。",
        allowSave: false,
        likeCount: 342,
        isLiked: false
      },
      12: {
        title: "夏季人设",
        artist: "官方设定",
        date: "2023-06-18",
        type: "created",
        image: "https://picsum.photos/seed/hasoook12/1200/1200",
        thumbnail: "https://picsum.photos/seed/hasoook12/800/800",
        description: "2023夏季新版人设，更新了服装和一些细节设计，希望能给大家带来新鲜感。这套设计更轻便适合夏季主题的视频内容。",
        allowSave: true,
        likeCount: 512,
        isLiked: false
      },
      13: {
        title: "游戏实况封面",
        artist: "视频专用",
        date: "2023-06-12",
        type: "created",
        image: "https://picsum.photos/seed/hasoook13/1200/1200",
        thumbnail: "https://picsum.photos/seed/hasoook13/800/800",
        description: "新系列游戏实况的专用封面，结合了游戏元素和个人形象设计。后续会根据游戏进度推出更多版本的封面图。",
        allowSave: true,
        likeCount: 278,
        isLiked: false
      }
    };
    
    // DOM元素
    const navbar = document.getElementById('navbar');
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const themeToggle = document.getElementById('theme-toggle');
    const tabFanart = document.getElementById('tab-fanart');
    const tabCreated = document.getElementById('tab-created');
    const mobileTabFanart = document.getElementById('mobile-tab-fanart');
    const mobileTabCreated = document.getElementById('mobile-tab-created');
    const fanartGallery = document.getElementById('fanart-gallery');
    const createdGallery = document.getElementById('created-gallery');
    const pageTitle = document.getElementById('page-title');
    const pageDescription = document.querySelector('#page-title + p');
    const imageModal = document.getElementById('image-modal');
    const modalImage = document.getElementById('modal-image');
    const modalTitle = document.getElementById('modal-title');
    const modalArtist = document.getElementById('modal-artist');
    const modalDate = document.getElementById('modal-date');
    const modalLikeCount = document.getElementById('modal-like-count').querySelector('span');
    const modalDescription = document.getElementById('modal-description');
    const closeModal = document.getElementById('close-modal');
    const sortBtns = document.querySelectorAll('.sort-btn');
    const loadMoreBtn = document.getElementById('load-more');
    const likeBtn = document.getElementById('like-btn');
    const likeIcon = document.getElementById('like-icon');
    const likeCountDisplay = document.getElementById('like-count-display');
    let currentImageId = null; // 当前查看的图片ID
    let currentSort = 'default'; // 当前排序方式
    
    // 初始化页面 - 渲染图片
    function initGallery() {
      renderGallery('fanart');
      renderGallery('created');
    }
    
    // 渲染指定类型的画廊
    function renderGallery(type) {
      const gallery = type === 'fanart' ? fanartGallery : createdGallery;
      const items = Object.values(imageData).filter(item => item.type === type);
      
      // 先清空画廊
      gallery.innerHTML = '';
      
      // 排序处理
      const sortedItems = sortItems([...items], currentSort);
      
      // 渲染排序后的项目
      sortedItems.forEach(item => {
        const isProtected = !item.allowSave;
        const heartClass = item.isLiked ? 'fa-heart like-animation' : 'fa-heart-o';
        const colorClass = type === 'fanart' ? 'text-primary' : 'text-secondary';
        
        const galleryItem = document.createElement('div');
        galleryItem.className = 'gallery-item card-hover bg-light-100 dark:bg-dark-100 rounded-xl overflow-hidden shadow-md';
        galleryItem.setAttribute('data-id', item.id);
        
        galleryItem.innerHTML = `
          <div class="image-container aspect-square cursor-pointer" data-id="${item.id}" 
            ${isProtected ? 'oncontextmenu="return false;" ondragstart="return false;"' : ''}>
            <img src="${item.thumbnail}" alt="${item.title}" class="image-thumbnail" 
              ${isProtected ? 'draggable="false"' : ''}>
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300 flex items-end">
              <div class="p-4 text-white">
                <h3 class="font-semibold">${item.title}</h3>
                <p class="text-sm text-gray-200">${item.artist}</p>
              </div>
            </div>
            <!-- 卡片上的喜欢按钮 -->
            <div class="absolute top-3 right-3 bg-white/80 dark:bg-black/50 backdrop-blur-sm rounded-full p-2 hover:bg-white dark:hover:bg-black/70 transition-colors">
              <i class="fa ${heartClass} ${colorClass}" data-id="${item.id}"></i>
              <span class="ml-1 text-sm font-medium ${colorClass}" data-id="${item.id}">${item.likeCount}</span>
            </div>
          </div>
          <div class="p-4">
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-500 dark:text-gray-400">${item.date}</span>
              <span class="px-2 py-1 text-xs rounded-full ${type === 'fanart' ? 'bg-primary/10 text-primary' : 'bg-secondary/10 text-secondary'}">
                ${type === 'fanart' ? '粉丝创作' : '官方'}
              </span>
            </div>
          </div>
        `;
        
        gallery.appendChild(galleryItem);
        
        // 绑定喜欢按钮事件
        const heartIcon = galleryItem.querySelector(`.fa-heart, .fa-heart-o`);
        heartIcon.addEventListener('click', (e) => {
          e.stopPropagation();
          toggleLike(item.id);
        });
        
        // 绑定点击查看详情事件
        const imageContainer = galleryItem.querySelector('.image-container');
        imageContainer.addEventListener('click', () => {
          openImageDetail(item.id);
        });
      });
    }
    
    // 排序处理函数
    function sortItems(items, sortType) {
      // 先给每个item添加id属性（用于排序后保持稳定性）
      items.forEach(item => {
        // 找到对应的id
        const id = Object.keys(imageData).find(key => imageData[key] === item);
        item.id = id;
      });
      
      switch(sortType) {
        case 'like-desc':
          // 按喜欢数量降序
          return items.sort((a, b) => {
            if (b.likeCount !== a.likeCount) {
              return b.likeCount - a.likeCount;
            }
            // 数量相同则按ID排序保持稳定
            return a.id - b.id;
          });
          
        case 'date-desc':
          // 按日期降序（最新在前）
          return items.sort((a, b) => {
            if (b.date !== a.date) {
              return new Date(b.date) - new Date(a.date);
            }
            return a.id - b.id;
          });
          
        case 'date-asc':
          // 按日期升序（最早在前）
          return items.sort((a, b) => {
            if (a.date !== b.date) {
              return new Date(a.date) - new Date(b.date);
            }
            return a.id - b.id;
          });
          
        case 'default':
        default:
          // 默认按ID排序
          return items.sort((a, b) => a.id - b.id);
      }
    }
    
    // 切换喜欢状态
    function toggleLike(imageId) {
      const data = imageData[imageId];
      if (!data) return;
      
      // 切换喜欢状态
      data.isLiked = !data.isLiked;
      
      // 更新喜欢数量
      data.likeCount += data.isLiked ? 1 : -1;
      
      // 更新所有地方的显示
      updateLikeDisplay(imageId, data);
    }
    
    // 更新喜欢显示
    function updateLikeDisplay(imageId, data) {
      // 更新卡片上的显示
      const cardLikeIcons = document.querySelectorAll(`.image-container [data-id="${imageId}"].fa-heart, .image-container [data-id="${imageId}"].fa-heart-o`);
      const cardLikeCounts = document.querySelectorAll(`.image-container span[data-id="${imageId}"]`);
      
      cardLikeIcons.forEach(icon => {
        if (data.isLiked) {
          icon.classList.remove('fa-heart-o');
          icon.classList.add('fa-heart', 'like-animation');
        } else {
          icon.classList.remove('fa-heart', 'like-animation');
          icon.classList.add('fa-heart-o');
        }
      });
      
      cardLikeCounts.forEach(countElem => {
        countElem.textContent = data.likeCount;
      });
      
      // 如果当前在详情页，更新详情页显示
      if (currentImageId === imageId) {
        likeCountDisplay.textContent = data.likeCount;
        modalLikeCount.textContent = data.likeCount;
        
        if (data.isLiked) {
          likeIcon.classList.remove('fa-heart-o');
          likeIcon.classList.add('fa-heart', 'like-animation');
        } else {
          likeIcon.classList.remove('fa-heart', 'like-animation');
          likeIcon.classList.add('fa-heart-o');
        }
      }
    }
    
    // 打开图片详情
    function openImageDetail(imageId) {
      currentImageId = imageId;
      const data = imageData[imageId];
      
      if (data) {
        modalImage.src = data.image;
        modalImage.alt = data.title;
        modalTitle.textContent = data.title;
        modalArtist.textContent = data.artist;
        modalDate.textContent = data.date;
        modalLikeCount.textContent = data.likeCount;
        modalDescription.textContent = data.description;
        
        // 更新喜欢按钮状态
        likeCountDisplay.textContent = data.likeCount;
        const colorClass = data.type === 'fanart' ? 'text-primary' : 'text-secondary';
        const hoverClass = data.type === 'fanart' ? 'hover:bg-primary' : 'hover:bg-secondary';
        
        if (data.isLiked) {
          likeIcon.className = `fa fa-heart text-xl ${colorClass} like-animation`;
          likeBtn.className = `flex-1 py-3 rounded-lg ${data.type === 'fanart' ? 'bg-primary' : 'bg-secondary'} text-white transition-all duration-300 flex items-center justify-center gap-2 font-medium`;
        } else {
          likeIcon.className = `fa fa-heart-o text-xl ${colorClass}`;
          likeBtn.className = `flex-1 py-3 rounded-lg bg-light-300 dark:bg-dark-300 ${hoverClass} hover:text-white transition-all duration-300 flex items-center justify-center gap-2 font-medium`;
        }
        
        // 显示模态框
        imageModal.classList.remove('opacity-0', 'pointer-events-none');
        imageModal.querySelector('div').classList.remove('scale-95');
        imageModal.querySelector('div').classList.add('scale-100');
        document.body.style.overflow = 'hidden';
      }
    }
    
    // 关闭图片详情
    function closeImageModal() {
      imageModal.classList.add('opacity-0', 'pointer-events-none');
      imageModal.querySelector('div').classList.remove('scale-100');
      imageModal.querySelector('div').classList.add('scale-95');
      document.body.style.overflow = '';
      currentImageId = null;
    }
    
    // 滚动时导航栏效果
    window.addEventListener('scroll', () => {
      if (window.scrollY > 50) {
        navbar.classList.add('py-2', 'shadow');
        navbar.classList.remove('py-3', 'md:py-4', 'shadow-sm');
      } else {
        navbar.classList.add('py-3', 'md:py-4', 'shadow-sm');
        navbar.classList.remove('py-2', 'shadow');
      }
    });
    
    // 移动端菜单切换
    mobileMenuBtn.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });
    
    // 主题切换
    themeToggle.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
    });
    
    // 检查本地存储的主题偏好
    if (localStorage.getItem('theme') === 'dark' || 
        (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
    
    // 切换图片分类
    function switchToFanart() {
      fanartGallery.classList.remove('hidden');
      createdGallery.classList.add('hidden');
      pageTitle.textContent = '粉丝投稿作品';
      pageDescription.textContent = '感谢大家的喜爱与创作，这里收集了所有粉丝绘制的Hasoook人设作品，每一份都是独特的心意。';
      
      // 更新导航状态
      tabFanart.classList.add('active', 'text-primary', 'border-b-2', 'border-primary');
      tabFanart.classList.remove('text-gray-600', 'dark:text-gray-400');
      tabCreated.classList.remove('active', 'text-primary', 'border-b-2', 'border-primary');
      tabCreated.classList.add('text-gray-600', 'dark:text-gray-400');
      
      mobileTabFanart.classList.add('active', 'text-primary');
      mobileTabFanart.classList.remove('text-gray-600', 'dark:text-gray-400');
      mobileTabCreated.classList.remove('active', 'text-primary');
      mobileTabCreated.classList.add('text-gray-600', 'dark:text-gray-400');
      
      // 关闭移动菜单
      mobileMenu.classList.add('hidden');
    }
    
    function switchToCreated() {
      fanartGallery.classList.add('hidden');
      createdGallery.classList.remove('hidden');
      pageTitle.textContent = '官方创作作品';
      pageDescription.textContent = '这里展示的是官方定制的Hasoook人设、表情和各类图片，用于视频创作和粉丝互动。';
      
      // 更新导航状态
      tabCreated.classList.add('active', 'text-primary', 'border-b-2', 'border-primary');
      tabCreated.classList.remove('text-gray-600', 'dark:text-gray-400');
      tabFanart.classList.remove('active', 'text-primary', 'border-b-2', 'border-primary');
      tabFanart.classList.add('text-gray-600', 'dark:text-gray-400');
      
      mobileTabCreated.classList.add('active', 'text-primary');
      mobileTabCreated.classList.remove('text-gray-600', 'dark:text-gray-400');
      mobileTabFanart.classList.remove('active', 'text-primary');
      mobileTabFanart.classList.add('text-gray-600', 'dark:text-gray-400');
      
      // 关闭移动菜单
      mobileMenu.classList.add('hidden');
    }
    
    tabFanart.addEventListener('click', switchToFanart);
    tabCreated.addEventListener('click', switchToCreated);
    mobileTabFanart.addEventListener('click', switchToFanart);
    mobileTabCreated.addEventListener('click', switchToCreated);
    
    // 排序按钮事件
    sortBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        // 更新按钮状态
        sortBtns.forEach(b => {
          b.classList.remove('active', 'bg-primary', 'text-white');
          b.classList.add('bg-light-300', 'dark:bg-dark-100', 'hover:bg-primary/10');
        });
        btn.classList.add('active', 'bg-primary', 'text-white');
        btn.classList.remove('bg-light-300', 'dark:bg-dark-100', 'hover:bg-primary/10');
        
        // 获取排序类型并应用排序
        currentSort = btn.getAttribute('data-sort');
        
        // 对当前显示的画廊进行排序
        if (!fanartGallery.classList.contains('hidden')) {
          renderGallery('fanart');
        } else {
          renderGallery('created');
        }
      });
    });
    
    // 喜欢按钮事件
    likeBtn.addEventListener('click', () => {
      if (currentImageId) {
        toggleLike(currentImageId);
      }
    });
    
    // 关闭模态框事件
    closeModal.addEventListener('click', closeImageModal);
    
    // 点击模态框背景关闭
    imageModal.addEventListener('click', (e) => {
      if (e.target === imageModal) {
        closeImageModal();
      }
    });
    
    // 按ESC键关闭
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !imageModal.classList.contains('pointer-events-none')) {
        closeImageModal();
      }
    });
    
    // 加载更多按钮
    loadMoreBtn.addEventListener('click', () => {
      // 模拟加载中状态
      loadMoreBtn.innerHTML = '<i class="fa fa-spinner fa-spin mr-2"></i> 加载中...';
      loadMoreBtn.disabled = true;
      
      // 2秒后恢复原状
      setTimeout(() => {
        loadMoreBtn.innerHTML = '加载更多 <i class="fa fa-chevron-down ml-1"></i>';
        loadMoreBtn.disabled = false;
        
        // 显示提示
        const notification = document.createElement('div');
        notification.className = 'fixed bottom-6 left-1/2 -translate-x-1/2 bg-dark-200 dark:bg-light-100 text-white dark:text-gray-800 px-6 py-3 rounded-full shadow-lg z-50';
        notification.textContent = '已经加载全部内容啦~';
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.classList.add('opacity-0', 'transition-opacity', 'duration-500');
          setTimeout(() => notification.remove(), 500);
        }, 2000);
      }, 1500);
    });
    
    // 初始化页面
    window.addEventListener('DOMContentLoaded', initGallery);
  </script>
</body>
</html>
