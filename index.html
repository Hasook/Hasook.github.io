<!DOCTYPE html>
<html>
<head>
    <title>实时记录句子</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <h1>实时记录句子</h1>
    
    <div>
        <input type="text" id="sentenceInput" placeholder="输入句子">
        <button onclick="addSentence()">添加</button>
    </div>
    
    <ul id="sentenceList">
    </ul>
    
    <script>
        // GitHub库信息
        const username = 'Hasook';
        const repo = 'Hasook.github.io
';
        const branch = 'main';
        const path = 'sentences.txt';
        
        // GitHub API认证信息
        const token = 'hh2002512';
        
        // 获取句子列表
        function getSentences() {
            $.ajax({
                url: `https://api.github.com/repos/${username}/${repo}/contents/${path}?ref=${branch}`,
                headers: {
                    'Authorization': `Bearer ${token}`
                },
                method: 'GET',
                success: function(data) {
                    const sentences = atob(data.content).split('\n');
                    const sentenceList = $('#sentenceList');
                    sentenceList.empty();
                    sentences.forEach(sentence => {
                        if (sentence.trim() !== '') {
                            sentenceList.append(`<li>${sentence}</li>`);
                        }
                    });
                }
            });
        }
        
        // 添加句子
        function addSentence() {
            const sentenceInput = $('#sentenceInput');
            const sentence = sentenceInput.val();
            if (sentence.trim() !== '') {
                $.ajax({
                    url: `https://api.github.com/repos/${username}/${repo}/contents/${path}`,
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    method: 'GET',
                    success: function(data) {
                        const content = atob(data.content);
                        const sentences = content.split('\n');
                        sentences.push(sentence);
                        const newContent = btoa(sentences.join('\n'));
                        
                        $.ajax({
                            url: `https://api.github.com/repos/${username}/${repo}/contents/${path}`,
                            headers: {
                                'Authorization': `Bearer ${token}`
                            },
                            method: 'PUT',
                            data: JSON.stringify({
                                message: 'Add sentence',
                                content: newContent,
                                sha: data.sha,
                                branch: branch
                            }),
                            success: function() {
                                sentenceInput.val('');
                                getSentences();
                            }
                        });
                    }
                });
            }
        }
        
        // 页面加载完成后获取句子列表
        $(document).ready(function() {
            getSentences();
        });
    </script>
</body>
</html>
